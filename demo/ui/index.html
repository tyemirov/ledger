<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ledger Demo Wallet</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/MarcoPoloResearchLab/mpr-ui@latest/mpr-ui.css"
    />
    <link rel="stylesheet" href="./styles.css" />
    <script type="module">
      import Alpine from "https://cdn.jsdelivr.net/npm/alpinejs@3.13.5/dist/module.esm.js";
      window.Alpine = Alpine;
      Alpine.start();
    </script>
    <script
      defer
      src="http://localhost:8080/static/auth-client.js"
      crossorigin="anonymous"
    ></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/gh/MarcoPoloResearchLab/mpr-ui@latest/mpr-ui.js"
      id="mpr-ui-bundle"
    ></script>
    <script
      src="https://accounts.google.com/gsi/client"
      async
      defer
    ></script>
  </head>
  <body data-auth-state="signed-out">
    <mpr-header
      id="demo-header"
      data-site-id="991677581607-r0dj8q6irjagipali0jpca7nfp8sfj9r.apps.googleusercontent.com"
      brand-label="Ledger Demo"
      brand-href="#"
      nav-links='[{"label":"Scenario","href":"#scenario"}]'
      base-url="http://localhost:8080"
      login-path="/auth/google"
      logout-path="/auth/logout"
      nonce-path="/auth/nonce"
      settings="true"
      settings-label="Profile"
    ></mpr-header>

    <main class="demo-layout">
      <section class="panel" data-auth-message>
        <h2>Sign in to begin</h2>
        <p>Use the header button to authenticate with TAuth. The demo loads automatically.</p>
      </section>

      <section class="panel" data-wallet hidden>
        <header class="panel-header">
          <div>
            <p class="panel-eyebrow">Available balance</p>
            <p class="panel-metric"><span data-available-coins>0</span> coins</p>
          </div>
          <div>
            <p class="panel-eyebrow">Total grants</p>
            <p class="panel-metric"><span data-total-coins>0</span> coins</p>
          </div>
        </header>
        <p class="panel-body-text">
          Every account receives <strong>20 coins</strong> on first login. Each transaction
          spends exactly <strong>5 coins</strong>. Buying more coins instantly updates the ledger.
        </p>
        <dl class="balance-breakdown">
          <div>
            <dt>Total (cents)</dt>
            <dd data-total-cents>0</dd>
          </div>
          <div>
            <dt>Available (cents)</dt>
            <dd data-available-cents>0</dd>
          </div>
        </dl>
      </section>

      <section class="panel" data-transactions hidden>
        <h2>Spend 5 coins</h2>
        <p>Validate both success and rejection flows with the same button.</p>
        <button type="button" class="cta" data-transact>Spend 5 coins</button>
        <p class="status" data-transaction-status>Waiting for action…</p>
      </section>

      <section class="panel" data-purchase hidden>
        <h2>Buy more coins</h2>
        <p>Select how many coins to add (min 5, steps of 5) and click purchase.</p>
        <form data-purchase-form>
          <div class="purchase-options">
            <label>
              <input type="radio" name="purchase" value="5" checked />
              <span>5 coins</span>
            </label>
            <label>
              <input type="radio" name="purchase" value="10" />
              <span>10 coins</span>
            </label>
            <label>
              <input type="radio" name="purchase" value="20" />
              <span>20 coins</span>
            </label>
          </div>
          <button type="submit" class="cta secondary">Buy coins</button>
        </form>
      </section>

      <section class="panel" data-history hidden>
        <h2 id="scenario">Ledger history</h2>
        <p class="panel-body-text">
          Track every grant and spend. Use these entries to confirm the “success, insufficient
          funds, zero balance” scenarios described in the plan.
        </p>
        <ul class="entry-list" data-entry-list></ul>
      </section>
    </main>

    <div class="status-banner" data-status-banner hidden></div>

    <mpr-footer
      prefix-text="Built with mpr-ui"
      privacy-link-label="Privacy"
      privacy-link-href="#"
      links='[{"label":"Plan","url":"https://github.com/MarkoPoloResearchLab/ledger"}]'
    ></mpr-footer>

    <script defer src="http://localhost:8080/demo/config.js"></script>
    <script type="module" src="./app.js"></script>
  </body>
</html>
